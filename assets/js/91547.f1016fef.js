"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([[91547],{91547:function(t,e,i){i.r(e),i.d(e,{dyte_notifications:function(){return u}});var n=i(13441),o=i(88876),s=i(10620),a=i(14878),r=i(10670);const c={joined:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",message:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3"};class d{constructor(){this.audio=document.createElement("audio"),this.audio.volume=.3}play(t,e=3e3){var i;this.playing||(this.playing=!0,this.audio.src=c[t],this.audio.volume=.3,null===(i=this.audio.play())||void 0===i||i.catch((i=>{o.l.error("[dyte-notifications] play() failed\n",{sound:t,duration:e},i)})),setTimeout((()=>{this.playing=!1}),e))}async setDevice(t){var e,i,n;await(null===(n=null===(i=null===(e=this.audio)||void 0===e?void 0:e.setSinkId)||void 0===i?void 0:i.call(e,t))||void 0===n?void 0:n.catch((t=>{o.l.error("[dyte-notifications] setSinkId() error\n",t)})))}}let l=(t=21)=>{let e="",i=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=63&i[t];e+=n<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n<63?"_":"-"}return e};const u=class{constructor(t){(0,n.r)(this,t),this.notificationPermissions={participant_joined:!1,participant_left:!1,chat:!1},this.soundPermissions={participant_joined:!1,participant_left:!1,chat:!1},this.t=(0,r.u)(),this.iconPack=a.d,this.notifications=[]}connectedCallback(){this.meetingChanged(this.meeting),this.configChanged(this.config)}disconnectedCallback(){null!=this.meeting&&(this.participantJoinedListener&&this.meeting.participants.joined.removeListener("participantJoined",this.participantJoinedListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),this.chatUpdateListener&&this.meeting.chat.removeListener("chatUpdate",this.chatUpdateListener),this.networkUpdateListener&&this.meeting.self.removeListener("disconnected",this.networkUpdateListener),this.networkUpdateListener&&this.meeting.self.removeListener("connected",this.networkUpdateListener))}meetingChanged(t){if(null!=t){this.audio=new d,this.participantJoinedListener=t=>{this.notificationPermissions.participant_joined&&this.add({id:`${t.id}-joined`,message:`${(0,s.f)(t.name)} just joined`,image:t.picture,duration:2100}),this.soundPermissions.participant_joined&&this.audio.play("joined")},this.participantLeftListener=t=>{this.notificationPermissions.participant_left&&this.add({id:`${t.id}-left`,message:`${(0,s.f)(t.name)} left`,image:t.picture,duration:2100})},this.chatUpdateListener=({message:e})=>{if(null!=e){if(e.userId===t.self.id)return;"text"===e.type&&(this.notificationPermissions.chat&&this.add({id:`message-${l(7)}`,icon:this.iconPack.chat,message:`${e.displayName}: ${(0,s.s)(e.message,20)}`,duration:2e3}),this.soundPermissions.chat&&this.audio.play("message"))}},this.deviceUpdateListener=({device:t,preview:e})=>{e||"audiooutput"===t.kind&&this.audio.setDevice(t.deviceId)},this.networkUpdateListener=({event:t})=>{let e;this.remove("network"),"disconnected"===t?(e=2e4,this.add({id:"network",icon:this.iconPack.disconnected,message:this.t("Connection lost. Trying to reconnect..."),duration:e}),this.states.disconnectTimeout=setTimeout((()=>{var t;this.states.roomLeftState="disconnected",null===(t=this.meeting)||void 0===t||t.leaveRoom()}),e)):"connected"===t&&(e=3e3,this.add({id:"network",icon:this.iconPack.wifi,message:this.t("Connection restored"),duration:e}),clearTimeout(this.states.disconnectTimeout))};const e=t.self.getCurrentDevices();null!=e.speaker&&this.audio.setDevice(e.speaker.deviceId),t.participants.joined.addListener("participantJoined",this.participantJoinedListener),t.participants.joined.addListener("participantLeft",this.participantLeftListener),t.chat.addListener("chatUpdate",this.chatUpdateListener),t.self.addListener("deviceUpdate",this.deviceUpdateListener),t.meta.addListener("disconnected",(()=>this.networkUpdateListener({event:"disconnected"}))),t.meta.addListener("connected",(()=>this.networkUpdateListener({event:"connected"})))}}configChanged(t){var e,i,n,o,s,a,r,c,d,l,u,p;null!=t&&(this.notificationPermissions.participant_joined=null===(i=null===(e=t.config)||void 0===e?void 0:e.notifications)||void 0===i?void 0:i.includes("participant_joined"),this.notificationPermissions.participant_left=null===(o=null===(n=t.config)||void 0===n?void 0:n.notifications)||void 0===o?void 0:o.includes("participant_left"),this.notificationPermissions.chat=null===(a=null===(s=t.config)||void 0===s?void 0:s.notifications)||void 0===a?void 0:a.includes("chat"),this.soundPermissions.participant_joined=null===(c=null===(r=t.config)||void 0===r?void 0:r.notification_sounds)||void 0===c?void 0:c.includes("participant_joined"),this.soundPermissions.participant_left=null===(l=null===(d=t.config)||void 0===d?void 0:d.notification_sounds)||void 0===l?void 0:l.includes("participant_left"),this.soundPermissions.chat=null===(p=null===(u=t.config)||void 0===u?void 0:u.notification_sounds)||void 0===p?void 0:p.includes("chat"))}statesUpdate(t){var e,i;if(null!=t){const n=!t.prefs.muteNotificationSounds,o=null===(i=null===(e=this.config)||void 0===e?void 0:e.config)||void 0===i?void 0:i.notification_sounds;for(const t in this.soundPermissions)(null==o?void 0:o.includes(t))&&(this.soundPermissions[t]=n)}}add(t){"visible"===document.visibilityState&&(this.notifications=[...this.notifications,t])}remove(t){this.notifications=this.notifications.filter((e=>e.id!==t))}handleDismiss(t){t.stopPropagation();const e=t.detail,i=this.host.shadowRoot.querySelector(`[data-id="${e}"]`);null!=i&&i.classList.add("exit"),setTimeout((()=>{(0,n.w)((()=>{this.remove(e)}))}),400)}render(){return(0,n.h)(n.H,null,this.notifications.map((t=>(0,n.h)("dyte-notification",{size:this.size,key:t.id,"data-id":t.id,notification:t,onDismiss:t=>this.handleDismiss(t)}))))}get host(){return(0,n.g)(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesUpdate"]}}};u.style=":host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;z-index:10;display:flex;flex-direction:column;pointer-events:none}dyte-notification{margin-top:var(--dyte-space-2, 8px)}"},10670:function(t,e,i){i.d(e,{g:function(){return o},u:function(){return s}});const n={chat:"Chat",participants:"Participants",polls:"Polls",plugins:"Plugins",mic_off:"Mic Off",mic_on:"Mic On",video_off:"Video Off",video_on:"Video On",left_meeting:"You left the meeting",share_screen_start:"Share Screen",share_screen_stop:"Stop Sharing",leave:"Leave",dismiss:"Dismiss",page:"Page",settings:"Settings",audio:"Audio",video:"Video",connection:"Connection",leave_confirmation:"Are you sure you want to leave the call?",end_meeting_for_all:"End meeting for all",cancel:"Cancel"},o=async t=>{if(null==t||"en"===t||""===t.trim())return n;try{const e=await fetch(`http://localhost:5000/${t}.json`);return e.ok?Object.assign({},n,await e.json()):n}catch(e){return n}},s=(t=n)=>e=>{var i;return null!==(i=t[e])&&void 0!==i?i:e}},88876:function(t,e,i){i.d(e,{l:function(){return r}});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};var o,s,a,r=(o=function(t){var e,i;e=n,i=function(){var t=function(){},e="undefined",i=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function o(t,e){var i=t[e];if("function"==typeof i.bind)return i.bind(t);try{return Function.prototype.bind.call(i,t)}catch(n){return function(){return Function.prototype.apply.apply(i,[t,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(n){return"debug"===n&&(n="log"),typeof console!==e&&("trace"===n&&i?s:void 0!==console[n]?o(console,n):void 0!==console.log?o(console,"log"):t)}function r(e,i){for(var o=0;o<n.length;o++){var s=n[o];this[s]=o<e?t:this.methodFactory(s,e,i)}this.log=this.debug}function c(t,i,n){return function(){typeof console!==e&&(r.call(this,i,n),this[t].apply(this,arguments))}}function d(t,e,i){return a(t)||c.apply(this,arguments)}function l(t,i,o){var s,a=this;i=null==i?"WARN":i;var c="loglevel";function l(){var t;if(typeof window!==e&&c){try{t=window.localStorage[c]}catch(o){}if(typeof t===e)try{var i=window.document.cookie,n=i.indexOf(encodeURIComponent(c)+"=");-1!==n&&(t=/^([^;]+)/.exec(i.slice(n))[1])}catch(o){}return void 0===a.levels[t]&&(t=void 0),t}}"string"==typeof t?c+=":"+t:"symbol"==typeof t&&(c=void 0),a.name=t,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=o||d,a.getLevel=function(){return s},a.setLevel=function(i,o){if("string"==typeof i&&void 0!==a.levels[i.toUpperCase()]&&(i=a.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(s=i,!1!==o&&function(t){var i=(n[t]||"silent").toUpperCase();if(typeof window!==e&&c){try{return void(window.localStorage[c]=i)}catch(o){}try{window.document.cookie=encodeURIComponent(c)+"="+i+";"}catch(o){}}}(i),r.call(a,i,t),typeof console===e&&i<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(t){i=t,l()||a.setLevel(t,!1)},a.resetLevel=function(){a.setLevel(i,!1),function(){if(typeof window!==e&&c){try{return void window.localStorage.removeItem(c)}catch(t){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(t){}}}()},a.enableAll=function(t){a.setLevel(a.levels.TRACE,t)},a.disableAll=function(t){a.setLevel(a.levels.SILENT,t)};var u=l();null==u&&(u=i),a.setLevel(u,!1)}var u=new l,p={};u.getLogger=function(t){if("symbol"!=typeof t&&"string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=p[t];return e||(e=p[t]=new l(t,u.getLevel(),u.methodFactory)),e};var f=typeof window!==e?window.log:void 0;return u.noConflict=function(){return typeof window!==e&&window.log===u&&(window.log=f),u},u.getLoggers=function(){return p},u.default=u,u},t.exports?t.exports=i():e.log=i()},o(a={path:s,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},a.exports),a.exports);r.enableAll()},10620:function(t,e,i){i.d(e,{a:function(){return s},f:function(){return a},h:function(){return o},s:function(){return n}});const n=(t,e=20)=>null==t?"":t.length>e?`${t.substring(0,e)}...`:t,o=t=>/^\p{Emoji}+$/u.test(t),s=t=>t.trim().toLowerCase().startsWith("javascript:")?"https://dyte.io":t,a=t=>""===(t=t.trim())?"Participant":t}}]);